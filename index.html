<html>
  <body style="background:#000">
    <canvas style="height:96%;position:fixed;top:50%;left:50%;transform:translate3d(-50%,-50%,0)" id="c" width="360" height="640"></canvas>
    <script>
      let ctx = c.getContext('2d');
      ctx.font = '16px monospace';
      ctx.lineWidth = 2;

      // for minification
      let canvasHeight = c.height;
      let canvasWidth = c.width;

      /**
       * I use the functions quite often and 
       * there is no way to minify the canvas ctx method
       */
      let fillRect = ctx.fillRect.bind(ctx); 
      let fillStyle = c => ctx.fillStyle = '#' + c;

      let palette = { a: '000', b: 'fff', c: 'f71', d: 'f20', e: 'eec' };

      /*
       * each pixel is coded with a color from the palette,
       * then RLE is applied to the entire string
       */
      let bird = `a6u8a2c3ab2au6ac4ab4au4ac5ab3abau2ac6ab3abau2ac7ab4au2ac8a6uac7ad6auac5ada6u2ac6ad5au3a2c5a5u6a5`;
      let wing1 = `a4u2ae4auae5a2e5auae3au3a3`;
      let wing2 = `a5uae5a2e5aua5u`;
      let wing3 = `a5uae5a2e4auae3au3a4`;
      
      let tick = 0;
      let y, vSpeed, playing, score, pipes;
      let hSpeed = 4.3;
      let gravityAcceleration = .48;
      let jumpSpeed = -11.54;
      let bestScore = 0;
      let pipeWidth = 64;
      let pipeGap = 220;
      let pipeEdge = () => (Math.random() * ((canvasHeight - (pipeGap + pipeWidth)) - pipeWidth)) + pipeWidth;

      let draw = (t, x, y, w, i = 0) => {
        while (t.length) {
          let c = t[0], times = +t[1]; // let's hope that one character is not repeated more than 9 times
          let noTimes = times !== times;
          fillStyle(palette[c]);
          t = t.slice(noTimes ? 1 : 2);

          noTimes && fillRect(x + (i % w) * 2, y + ((i / w) | 0) * 2, 2, 2);

          if (c === 'u' || noTimes) {
            i += times || 1;
            continue
          }

          let until = times + i;
          for (; i < until; i++) {
            fillRect(x + (i % w) * 2, y + ((i / w) | 0) * 2, 2, 2);
          }
        }
      }

      let setup = () => {
        vSpeed = jumpSpeed;
        playing = 0;
        score = 0;
        y = 308;
        pipes = Array(2).fill().map((_, i) => [canvasWidth * 1.4 + (i * (pipeGap + pipeWidth)), pipeEdge()]);
      }

      let render = () => {
        fillStyle("0ac");
        fillRect(0, 0, 360, 640);
        
        if (playing) {
          vSpeed += gravityAcceleration;
          y += vSpeed;

          pipes.map(pipe => {
            pipe[0] -= hSpeed;

            let x = pipe[0];
            fillStyle('1a0');
            fillRect(x + 2, 0, pipeWidth - 2, canvasHeight);
            
            fillStyle('170');
            fillRect(x + 52, 0, 12, canvasHeight);

            fillStyle('1d0');
            fillRect(x + 8, 0, 4, canvasHeight);
            fillRect(x + 16, 0, 12, canvasHeight);
            fillRect(x + 32, 0, 4, canvasHeight);

            fillStyle('000');
            ctx.strokeRect(x - 1, pipe[1] - 32, pipeWidth + 4, 32);
            ctx.strokeRect(x - 1, pipe[1] + pipeGap + 1, pipeWidth + 4, 32);

            fillRect(x, 0, 2, canvasHeight);
            fillRect(x + pipeWidth, 0, 2, canvasHeight);
            fillRect(x, pipe[1] + pipeGap, pipeWidth, 2);
            fillRect(x, pipe[1] - 1, pipeWidth, 2);

            fillStyle('0ac');
            fillRect(x - 1, pipe[1] + 1, pipeWidth + 4, pipeGap - 1);

            if (x < -pipeWidth) {
              score++;
              bestScore = Math.max(bestScore, score);
              pipes = [...pipes.slice(1), [pipes[1][0] + pipeGap + pipeWidth, pipeEdge()]];
            }
          })

          let [firstPipe] = pipes;

          if ((
            firstPipe[0] < canvasWidth / 2 + 18 && 
            firstPipe[0] + pipeWidth > canvasWidth / 2 - 18 &&
            (y < firstPipe[1] || firstPipe[1] + pipeGap < y + 32)
          ) || (
            y < 0 || y > 616
          )) {
            setup();
          }
        } else {
          fillStyle('fff');
          ctx.fillText(`Click to play`, 120, 370);
        }

        draw(bird, 164, y, 16, 5);

        let wi = ((tick / 3) | 0) % 4;

        wi % 2 
          ? draw(wing2, 162, y + 10, 7, 1) 
          : wi === 0 
          ? draw(wing1, 162, y + 6, 7, 1) 
          : draw(wing3, 162, y + 12, 7, 1);

        fillStyle('fff');
        ctx.fillText(`Score: ${score} Best: ${bestScore}`, 16, 26);

        tick++;
      }

      setup();
      setInterval(render, 16);

      c.onclick = () => playing ? vSpeed = jumpSpeed : playing = 1;
    </script>
  </body>
</html>